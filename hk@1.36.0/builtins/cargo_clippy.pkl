import "../Builtins.pkl"
import "../Config.pkl"

@Builtins.meta {
  category = "Rust"
  description = "Rust linter"
  project_indicators {
    new { file = "Cargo.toml" }
  }
}
cargo_clippy = new Config.Step {
  glob = "**/*.rs"
  workspace_indicator = "Cargo.toml"
  check = "cargo clippy --manifest-path {{workspace_indicator}} --quiet"
  fix =
    "cargo clippy --manifest-path {{workspace_indicator}} --fix --allow-dirty --allow-staged --quiet"
  check_first = false
  env {
    ["CARGO_TERM_PROGRESS_WHEN"] = "never"
  }
}
